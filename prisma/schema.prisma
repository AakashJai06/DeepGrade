generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
id Int @id @default(autoincrement())
email String @unique
password String
firstName String
lastName String
role String
}
model questionpaper {
  qpid    String         @id @default(uuid()) // Unique Question Paper ID
  name    String
  questions questiondetails[]
  studentanswers studentanswers[]
}

model questiondetails {
  qd_id    String        @id @default(uuid()) 
  qpid     String        // Foreign key to QuestionPaper
  q_no     Int           // Question number for indexing
  question String
  answer   String
  evaluationCriteria String

  questionPaper questionpaper @relation(fields: [qpid], references: [qpid])
}

model Student {
  sid      String        @id @default(uuid()) 
  email     String      @unique
  roll      String     @unique
  answers  studentanswers[]
}

model studentanswers {
  sa_id    String        @id @default(uuid()) 
  qpid     String        // Foreign key to QuestionPaper
  roll     String        // Foreign key to Student
  q_no     Int           // Question number for indexing
  answer   String
  grade    Float         @default(0) // Stores the grade assigned to this answer

  questionPaper questionpaper @relation(fields: [qpid], references: [qpid])
  student       Student       @relation(fields: [roll], references: [roll])
    @@map("studentanswers")
    @@unique([qpid, roll, q_no])
}
